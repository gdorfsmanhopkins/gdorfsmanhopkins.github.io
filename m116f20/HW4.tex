\documentclass[11pt]{article}
\usepackage[top = 1in, bottom = 1in, left =1in, right = 1in]{geometry}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{tabu}
\usepackage{amssymb}
\usepackage{etoolbox}
\usepackage{xcolor}
\usepackage{amsthm}
\usepackage{tikz-cd}
\usepackage{tikz}
\AtBeginEnvironment{proof}{\color{blue}}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem*{facts}{Fact}
\newtheorem*{remark}{Remark}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{fancyhdr}\pagestyle{fancy}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\ab}{\mathrm{ab}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\Inn}{\operatorname{Inn}}
\newcommand{\im}{\operatorname{im}}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\ch}{\operatorname{char}}

%Math blackboard:
\newcommand{\bC}{\mathbb{C}}
\newcommand{\bF}{\mathbb{F}}
\newcommand{\bN}{\mathbb{N}}
\newcommand{\bQ}{\mathbb{Q}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\bS}{\mathbb{S}}
\newcommand{\bZ}{\mathbb{Z}}

%Math caligraphy
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cO}{\mathcal{O}}

%Greek blackboard font:
\newcommand{\bmu}{\mbox{$\raisebox{-0.59ex}
  {$l$}\hspace{-0.18em}\mu\hspace{-0.88em}\raisebox{-0.98ex}{\scalebox{2}
  {$\color{white}.$}}\hspace{-0.416em}\raisebox{+0.88ex}
  {$\color{white}.$}\hspace{0.46em}$}{}}

\lhead{University of California, Berkeley}
\rhead{Math 116, Fall 2020}

\begin{document}
\begin{center}
\Large {Homework 4}\\
\small {Due Thursday, October 1}
\end{center}
\section*{Implementation Part}
\begin{enumerate}
  \item{
  Let's begin by implementing the Elgamal cryptosystem.  Fix a prime $p$ and an element $g\in\bF_p^*$ and save them as global variables.
  \begin{enumerate}
    \item{
    Write Alice's algorithms: \verb|generatePublicKey(a)| which takes as input Alice's private key and returns her public key; and \verb|elgamalDecrypt(c1,c2,a)| which takes as input ciphertext $(c_1,c_2)$ as well as Alice's private key and returns a message.
    }
    \item{
    Write Bob's algorithm: \verb|elgamalEncrypt(m,A)| which takes as input Alice's public key $A$ and a message $m$ and returns ciphertext $(c_1,c_2)$.  (Recall that Bob needs to choose a random exponent to encrypt with.  \verb|ZZ.random_element(lowerBound,upperBound)| should come in handy).
    }
    \item{
    Test it out.  Let $p=9787$ and $g=34$.  Pick any exponent you like and generate a public key as Alice.  Then put on your Bob hat and encrypt a message (secret number).  Finally decrypt it as alice and make sure you got what you started with.  Do this for various values of $a$ and messages.
    }
    \item{
    I'm trying to send you a message.  Let
    \begin{eqnarray*}
      p&=&753022235974397591242683563886842009117\\
      g&=&47393028462819284673.
    \end{eqnarray*}
    Suppose further that your secret key is $a=314159265358979323846$.  I send you the following ciphertext:
    \begin{eqnarray*}(c_1,c_2) =& (449164960684688587557185888310931655332,\\
      &608713686463403616105013668689979824341).
    \end{eqnarray*}
    Decode my message. (Use \verb|intToText| to read it!)
    }
    \item{
    You're welcome to respond to my message.  With the same prime and generator, I have a public key of
    \[A = 418194837551245918495968754919547251501.\]
    Encode me a message.  You can just post in on discord and it should still be well enough encrypted so that only I can read it!
    }
  \end{enumerate}
  }
\end{enumerate}
\section*{Written Part}
In class we showed that an Elgamal oracle can solve the Diffie-Hellman problem.  Let's show the other direction, and conclude that Elgamal and Diffie-Hellman are equally difficult.
\begin{enumerate}
  \setcounter{enumi}{1}
  \item{
  Suppose you have access to an oracle who can solve the Diffie-Hellman problem.  That is, for any prime $p$, given $g^a$ and $g^b\mod p$, the oracle can tell you $g^{ab}\mod p$.  Show that you can use this oracle to crack the Elgamal Public Key Cryptosystem.  Precisely, suppose Alice publishes a prime $p$, an element $g\in\bF_p^*$, and a public key $A$, and Bob sends the cipher text $(c_1,c_2)$.  Consult with the oracle to find the message Bob sent.
  }
\end{enumerate}
Problem 2.10 in [HPS] gives an example of a cryptosystem where Alice and Bob need to send two rounds of messages back and forth to communicate.  We reproduce it here.  It might be fun to follow along on cocalc!
\begin{enumerate}
  \setcounter{enumi}{2}
  \item{
  Alice and Bob decide on a prime $p = 32611$.  The rest is secret.  But any information crossing the middle channel (via the arrows) should be assumed to be intercepted by Eve.\\
  \begin{tabular}{l|c||c||c}
    &Alice &Eve& Bob\\
    \hline\hline
    1.&Alice has message $m = 11111$&&\\
    \hline
    2.&Alice chooses random $a = 3589$&&\\
    \hline
    3.&Alice computes $u = m^a\mod p = 15950$ & $\longrightarrow$ &Bob recieves $u$\\
    \hline
    4.&&&Bob chooses random $b = 4037$.\\
    \hline
    5.&Alice recieves $v$ & $\longleftarrow$ & Bob Computes $v = u^b\mod p = 15422$\\
    \hline
    6.&Alice knows $a' = 15619$&&\\
    \hline
    7.&Alice computes $w=v^{a'}\mod p = 27257$&$\longrightarrow$&Bob recieves $w$.\\
    \hline
    8.&&&Bob knows $b' = 31883$\\
    \hline
    9.&&&Bob computes $w^{b'}\mod p = 11111$.\\
    &&&That's $m$!
  \end{tabular}
  \begin{enumerate}
    \item{
    Notice how Alice knows a second exponent $a'=15619$ in step 6.  Where does this number come from and how does this relate to $a=3589$ from step 2?  Similarly how do Bob's exponenets $b=4037$ and $b'=31883$ relate? Use this information to explain how the algorithm works.
    }
    \item{
    Formulate a general version of this algorithm using variables and show that it works in general.
    }
    \item{
    Can a solution to the DLP break this cryptosystem?  Justify your answer.
    }
    \item{
    Can a solution to the DHP break this cryptosystem?  Justify your answer.
    }
  \end{enumerate}
  }

  The following exercises are adapted from 2.12-2.15 [HPS], and cover important properties and examples from group theory.
  \item{
  Let $G$ be a group, and $N$ a positive integer.  The \textit{$N$-torsion} of $G$ is the set:
  \[G[N]:=\{g\in G:g^N = 1\}.\]
  \begin{enumerate}
    \item{
    Prove that if $g\in G[N]$, then so is $g^{-1}$.
    }
    \item{
    Suppose that $G$ is commutative.  Prove that if $a,b\in G[N]$, then so is $a*b$
    }
    \item{
    Suppose that $G$ is commutative.  Prove that $G[N]$ is a group.
    }
  \end{enumerate}
  }
  \item{
  Let $G$ and $H$ be groups, and denote their multiplication rules by $*_G$ and $*_H$ respectively.  A function $\varphi:G\to H$ is called a \textit{homomorphism} if for all $a,b\in G$:
  \[\varphi(a*_G b) = \varphi(a)*_H\varphi(g).\]
  Homomorphisms have some nice properties:
  \begin{enumerate}
    \item{
    Let $e_G$ be the identity of $G$ and $e_H$ the identity of $H$.  Show that if $\varphi$ is a homomorphism then $\varphi(e_G) = e_H$
    }
    \item{
    Show that $\varphi(g^{-1})=\varphi(g)^{-1}$ for all $g\in G$.
    }
    \item{
    Let $G$ be a commutative group, show that the function $\varphi(g) = g^2$ is a homomorphism.  Do the same for the function $\psi(g) = g^{-1}$.  Highlight the steps whereyou needed $G$ to be commutative.
    }
    \item{
    Suppose $\varphi:G\to H$ is a homomorphism and is bijective.  Show that the inverse $\varphi^{-1}:H\to G$ is a homomorphism as well.  Such a map is called an \textit{isomorphism}.
    }
  \end{enumerate}
  }
  \item{
  Prove that the following maps are homomorphisms.
  \begin{enumerate}
    \item{
    The map $\varphi:\bZ\to\bZ/N\bZ$ taking $a\in\bZ$ to $a\mod N\in\bZ/N\bZ$.
    }
    \item{
    The map $\iota:\bR^*\to GL_2(\bR)$ defined by $r\mapsto\begin{pmatrix}r&0\\0&-r\end{pmatrix}$.
    }
    \item{
    Show that the discrete log map $\log_g:\bF_p^*\to\bZ/(p-1)\bZ$ is an isomorphism.
    }
  \end{enumerate}
  }
  \item{
  Matrix groups over finite fields are very interesting examples of finite groups, and essential in the study of linear algebra over finite fields.  Recall that $GL_2(\bF_p)$ is the set of 2 by 2 matrices with entries in $\bF_p$ and nonzero determinant.
  \begin{enumerate}
    \item{
    Prove $GL_2(\bF_p)$ is a group under matrix multiplication.
    }
    \item{
    Prove $GL_2(\bF_p)$ is noncommutative for every $p$.
    }
    \item{
    Write down all the elements of $GL_2(\bF_2)$ and the multiplication.
    }
    \item{
    Compute this size of $GL_2(\bF_p)$ in terms of $p$.  (\textit{Hint:} How many choices are there for the first column?  Once you fix this first column how many choices are there left for the second?)
    }
  \end{enumerate}
  }
  \item{
  Let's play with big $\cO$ notation.
  \begin{enumerate}
    \item{
    Show that $x^3 + 2x + 5 = \cO(x^3)$
    }
    \item{
    Let $f(x)$ be a polynomial of degree $n$.  Show that $f(x) = \cO(x^n)$.
    }
    \item{
    Show that $(\ln x)^{500} = \cO(x^{.01})$.
    }
    \item{
    Show that $k^22^k = \cO(3^k)$
    }
  \end{enumerate}
  }
\end{enumerate}
\end{document}
