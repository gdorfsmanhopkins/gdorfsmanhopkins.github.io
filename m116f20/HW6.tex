\documentclass[11pt]{article}
\usepackage[top = 1in, bottom = 1in, left =1in, right = 1in]{geometry}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{tabu}
\usepackage{amssymb}
\usepackage{etoolbox}
\usepackage{xcolor}
\usepackage{amsthm}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{seqsplit}
\usepackage{ulem}
\AtBeginEnvironment{proof}{\color{blue}}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem*{facts}{Fact}
\newtheorem*{remark}{Remark}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{fancyhdr}\pagestyle{fancy}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\ab}{\mathrm{ab}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\Inn}{\operatorname{Inn}}
\newcommand{\im}{\operatorname{im}}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\ch}{\operatorname{char}}

%Math blackboard:
\newcommand{\bC}{\mathbb{C}}
\newcommand{\bF}{\mathbb{F}}
\newcommand{\bN}{\mathbb{N}}
\newcommand{\bQ}{\mathbb{Q}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\bS}{\mathbb{S}}
\newcommand{\bZ}{\mathbb{Z}}

%Math caligraphy
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cO}{\mathcal{O}}

%Greek blackboard font:
\newcommand{\bmu}{\mbox{$\raisebox{-0.59ex}
  {$l$}\hspace{-0.18em}\mu\hspace{-0.88em}\raisebox{-0.98ex}{\scalebox{2}
  {$\color{white}.$}}\hspace{-0.416em}\raisebox{+0.88ex}
  {$\color{white}.$}\hspace{0.46em}$}{}}

\lhead{University of California, Berkeley}
\rhead{Math 116, Fall 2020}

\begin{document}
\begin{center}
\Large {Homework 6}\\
\small {Due Thursday, October 22}
\end{center}
\section*{Implementation Part}
\begin{enumerate}
  \item{
  Implement Pollard's $p-1$ algorithm to factor large numbers.  Explicitly, define an algorithm \verb|PollardFactor(N,a = 2,n = infinity)| which attempts to factor $N$ by computing the gcd of $a^{i!}-1$ and $N$ for $i\le n$.  It should default to computing factorial powers of $2$, and should default to running forever if you don't specify an upper bound (this is probably bad practice in general but is useful if you don't have a particular upper bound in mind and just want to have it run for a while to see if you can find a factorization).  Make sure to include an appropriate response if your algorithm ever computes $\gcd(a^{i!},N)=N$.  \textbf{Note:} It is important that every step in this algorithm be as streamlined as possible, eliminating any redudant computations to give the best possible chance of factoring a large number.
  }
  \item{
  Use your algorithm from part 1 to try and factor the following numbers.  (An upper bound of n=100000 or so may help for the last few).
  \begin{enumerate}
    \item{N = 13927189}
    \item{N = 168441398857}
    \item{N = 47317162267924657513}
    \item{N = 523097775055862871433433884291}
    \item{N = 515459117588889238503625135159}
  \end{enumerate}
  }
  \item{
  Let's gather some data on the prime number theorem and related things.  We will be using your function \verb|probablyPrime| from the first takehome assignment.
  \begin{enumerate}
    \item{
    Write a function \verb|pi(n)| which computes
    \[\pi(n):=\#\{\text{primes }p\text{ such that }p\le n\}.\]
    }
    \item{
    Compute the ratio $\pi(n)/(n/\ln n)$ for $n = 10,100,1000,10000,$ and $100000$.  Does this make you believe in the prime number theorem?  (Note: sage has a built in function \verb|ln(x)|, but you may need to cast your output as a float to see a decimal expansion of the output.)
    }
    \item{
    Write functions \verb|pi1(n)| and \verb|pi3(n)| which compute
    \begin{eqnarray*}
      \pi_1(n)&:=&\#\{\text{primes }p\text{ such that }p\le n\text{ and }p\equiv 1\mod 4\},\\
      \pi_3(n)&:=&\#\{\text{primes }p\text{ such that }p\le n\text{ and }p\equiv 3\mod 4\},
    \end{eqnarray*}
    respectively.
    }
    \item{
    Compute the ratio $\pi_1(n)/\pi_3(n)$ for $n = 10,100,1000,10000,$ and $100000$.  Make a conjecture about the ratio as $n\to\infty$.
    }
  \end{enumerate}
  }
\end{enumerate}
\section*{Written Part}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item{
  In question 2 parts (d) and (e) were similarly sized numbers, yet your algorithm probably only worked on one of them (mine did).  Explain why this is (\textit{Hint}: try factoring $p-1$ in sage for the one that worked.)
  }
  \item{
  Using your data from question 3(d), make a conjecture comparing the number of primes congruent to 1 modulo 4 and the number of primes congruent to 3 modulo 4.
  }
  \item{
  Recall the following definition:
  \begin{definition}
    A composite number $n$ is called a \textit{Carmichael Number} if $a^{n}\equiv a\mod n$ for every integer $a$.
  \end{definition}
  In essense, these are the composite numbers that satisfy Fermat's little theorem.   One way you could check if a number $n$ is a Carmichael number is to raise every integer $\le n$ to the $n$'th power.  But it turns out there is some interesting underlying structure to Carmichael numbers making their existence seem less coincidental.  Let's explore this:
  \begin{enumerate}
    \item{
    We begin by proving that our example 561 from class is a Carmichael number.  Notice that $561 = 3*11*17$.  Show that for every $a$ the following congruences hold:
    \begin{eqnarray*}
      a^{561}&\equiv& a\mod 3\\
      a^{561}&\equiv& a\mod 11\\
      a^{561}&\equiv& a\mod 17.
    \end{eqnarray*}
    Use this fact to prove that the same congruence holds mod 561 therefore proving that 561 is a Carmichael number.
    }
    \item{
    Use the same logic to show that $75361 = 11*13*17*31$ is a Carmichael number.
    }
  \end{enumerate}
  Hopefully we've now noticed a few patterns.  Let's extrapolate these to prove some general facts about Carmichael numbers.
  \begin{enumerate}
    \setcounter{enumii}{2}
    \item{
    Show that a Carmichael number must be odd.
    }
    \item{
    Show that a Carmichael number must factor into a product of distinct prime numbers (such a number is called \textit{square free}).
    }
    \item{
    Prove \textit{Korselt's criterion}: A composite number $n$ is a Carmichael number if and only if it is square free and for all prime divisors $p$ of $n$, we have $p-1|n-1$.
    }
  \end{enumerate}
  }
  \item{
  Here we give another characterization of the Legendre symbol from a group theoretic perspective.
  \begin{enumerate}
    \item{
    Let $G,H,K$ be groups, and let $\varphi:G\to H$ and $\psi:H\to K$ be homomorphisms.  Show that the composition $\psi\circ\varphi:G\to K$ is a homomorphism.
    }
    \item{
    Show that the set $\{\pm1\}$ is a group under multiplication.
    }
    \item{
    Let $N$ be a positive even integer.  Show that the map $\bZ/N\bZ\to\{\pm1\}$ given by the rule $x\mapsto (-1)^x$ is a well defined homomorphism (where the group law for $\bZ/N\bZ$ is addition).
    }
    \item{
    Let $p$ be an odd prime, and let $g\in\bF_p$ be a primitive root.  Show that the composition
    \[
    \begin{tikzcd}
      \bF_p^*\ar[r,"\log_g(\cdot)"]&\bZ/(p-1)\bZ\ar[r,"(\cdot)^x"]&\{\pm1\}
    \end{tikzcd}
    \]
    is equal to the Legendre function $x\mapsto\left(\frac{x}{p}\right)$.  Use this together with part (a)-(c) to give another proof that the Legendre symbol is multiplicative.
    }
  \end{enumerate}
  }
  \item{
  On previous assignments we've extesively studied the notion of squares modulo $p$ (i.e., \textit{quadratic residues mod $p$}), and one thing we noticed is that the situation differed depending on whether $p$ was even or odd (i.e., it depended on the residue of $p$ modulo $2$).  Here we begin our exploration of cube roots modulo $p$, and we will notice that the story depends on the the residue of $p$ modulo 3.  First a definition:
  \begin{definition}
    Let $p$ be a prime number.  An integer $a$ is called a \textit{cubic residue mod $p$} if $p\not|a$ and there exists an integer $c$ satisfying $c^3\equiv a\mod p$.
  \end{definition}
  Let's begin by studying the case where $p\equiv 1\mod 3$.  \textbf{For parts (a)-(d), assume $p\equiv1\mod 3$}.
  \begin{enumerate}
    \item{
    Let $a,b$ be cubic residues modulo $p$.  Show that $ab$ is a cubic residue mod $p$.
    }
    \item{
    Give an example to show that if $a$ and $b$ are cubic nonresidues mod $p$, then $ab$ could also be a nonresidue.  Explain why this is different from the situation of quadratic residues.
    }
    \item{
    Let $g$ be a primitive root for $\bF_p$.  Show that $a$ is a cubic residue modulo $p$ if and only if $\log_g a$ is a multiple of 3.
    }
    \item{
    Show that if $a$ is a cubic residue modulo $p$, then $a$ has precisely 3 cube roots modulo $p$.
    }
    \item{
    Part (c) showed that if $p\equiv 1\mod 3$ then one third of the elements of $\bF_p^*$ have cube roots.  The case where $p\equiv 2\mod 3$ is quite different.  Suppose $p\equiv 2\mod 3$.  Show that every integer has a cube root modulo $p$.  If $p\not|a$, how many cube roots does $a$ have mod $p$?
    }
    \item{
    Like in the case of square roots mod 2, the case of cube roots mod 3 is different still.  Show that every integer has \textit{precisely 1} cube root modulo 3.
    }
    \item{
    In fact, it is a general principle that $p$th roots modulo $p$ are very simple.  Prove that if $p$ is prime every integer has precisely one $p$th root modulo $p$.  (\textit{Hint}: Fermat's little theorem.)
    }
  \end{enumerate}
  }
\end{enumerate}
\end{document}
